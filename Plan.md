# 智能家居中控器项目开发计划

## 🗓️ 第一周：基础环境搭建与核心驱动开发

### 第1天：环境准备与基础验证
- [x] 安装STM32CubeIDE和必备软件
- [x] 创建STM32CubeMX工程，配置时钟树（168MHz）
- [x] 配置GPIO：点亮LED，测试按键输入
- [x] 配置串口1/2用于调试日志输出
- [x] 生成代码框架，编译下载测试

### 第2天：FreeRTOS基础框架
- [x] 在CubeMX中启用FreeRTOS
- [x] 创建2个测试任务（LED闪烁、串口打印）
- [x] 配置任务优先级和堆栈大小
- [x] 测试任务调度是否正常
- [x] 建立项目文件夹结构（App/BSP/Modules/System）

### 第3天：TFT液晶屏驱动
- [x] 配置SPI1接口（带DMA）用于TFT屏
- [x] 移植ST7735驱动代码
- [x] 实现基础绘图函数（画点、线、矩形、文字）
- [x] 测试屏幕显示，绘制简单界面

### 第4天：旋转编码器驱动
- [x] 配置编码器CLK、DT、SW引脚为外部中断
- [x] 编写编码器解码逻辑（状态机方式）
- [x] 实现编码器任务，处理旋转和按下事件
- [x] 测试编码器输入，通过串口输出事件

### 第5天：日志系统与传感器基础
- [x] 实现`bsp_log`日志系统，支持多级别输出
- [x] 配置ADC读取光敏电阻
- [x] 测试ADC采集，通过日志输出光照值
- [x] 统一调试所有已完成的驱动

---

## 🗓️ 第二周：外设集成与任务框架

### 第6天：温湿度传感器
- [x] 配置单总线时序读取DHT11
- [x] 实现DHT11驱动
- [x] 测试温湿度读取
- [x] 将数据通过日志系统输出

### 第7天：继电器控制与FreeRTOS通信
- [ ] 配置GPIO控制继电器模块
- [ ] 创建控制命令队列
- [ ] 实现Control_Task，监听队列执行控制
- [ ] 测试继电器开关控制

### 第8天：Wi-Fi网络连接
- [ ] 配置UART与ESP8266通信
- [ ] 实现AT指令驱动（连接Wi-Fi）
- [ ] 测试Wi-Fi连接状态获取
- [ ] 处理网络连接异常情况

### 第9天：MQTT协议实现
- [ ] 实现MQTT连接AT指令
- [ ] 完成MQTT订阅和发布功能
- [ ] 创建网络数据队列
- [ ] 测试MQTT与服务器通信

### 第10天：任务框架整合
- [ ] 创建所有任务：GUI、Sensor、Network、Control、Encoder
- [ ] 配置任务优先级和堆栈大小
- [ ] 建立任务间通信队列
- [ ] 测试多任务协同工作

---

## 🗓️ 第三周：应用逻辑与用户界面

### 第11天：GUI状态机设计
- [ ] 设计GUI页面结构（主页面、设置页面）
- [ ] 实现GUI状态机框架
- [ ] 处理编码器输入与页面切换
- [ ] 测试基础页面导航

### 第12天：传感器数据显示
- [ ] 在GUI主页面显示温湿度、光照数据
- [ ] 实现数据实时刷新机制
- [ ] 添加数据单位和小数点显示
- [ ] 测试数据显示准确性

### 第13天：设备控制界面
- [ ] 实现设备控制页面（灯光开关）
- [ ] 添加控制状态显示（开/关）
- [ ] 处理控制命令反馈
- [ ] 测试界面控制功能

### 第14天：数据自动上报
- [ ] 实现传感器数据定时上报MQTT
- [ ] 添加网络状态显示
- [ ] 处理网络断开重连
- [ ] 测试数据上报稳定性

### 第15天：远程控制集成
- [ ] 实现MQTT命令解析
- [ ] 处理远程控制命令
- [ ] 添加命令执行反馈
- [ ] 测试手机APP远程控制

---

## 🗓️ 第四周：系统优化与功能完善

### 第16天：系统设置功能
- [ ] 实现系统设置页面
- [ ] 添加Wi-Fi配置界面
- [ ] 实现参数保存到Flash
- [ ] 测试配置持久化

### 第17天：自动化场景
- [ ] 实现光照自动控制逻辑
- [ ] 添加自动化开关设置
- [ ] 测试自动化场景触发
- [ ] 优化控制算法

### 第18天：性能优化
- [ ] 优化GUI刷新效率（局部刷新）
- [ ] 调整任务优先级平衡系统负载
- [ ] 优化内存使用，检查堆栈溢出
- [ ] 进行压力测试

### 第19天：用户体验完善
- [ ] 添加操作音效（蜂鸣器）
- [ ] 完善界面视觉效果
- [ ] 添加系统启动画面
- [ ] 进行整体用户体验测试

### 第20天：最终测试与文档
- [ ] 进行48小时稳定性测试
- [ ] 修复发现的bug
- [ ] 整理代码，添加注释
- [ ] 编写项目文档和使用说明

---

